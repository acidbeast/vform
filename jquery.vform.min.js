(function(c){c.fn.vform=function(a){var a=c.extend({form:"form",type:"post",block:!0,loader:".loader",errorClass:"error",errorInput:!1,errorLabel:!1,errorMessage:!0,errorAlert:!1,connector:"data-field",message:"span.error",messageLabel:"label",alert:".alert",alertLabel:"label",submitCallback:void 0,errorCallback:void 0,successCallback:void 0},a||{}),d=c(this),k=c(a.loader),n=d.attr("action"),g=0,i={},f=function(b,h){if(b&&h){var e;if(c('input[name="'+b+'"]',d).length>0)e=c('input[name="'+b+'"]',d);
else if(c('textarea[name="'+b+'"]',d).length>0)e=c('textarea[name="'+b+'"]',d);else if(c('select[name="'+b+'"]',d).length>0)e=c('select[name="'+b+'"]',d);else return;a.errorInput&&e.addClass(a.errorClass);if(a.errorLabel){var f=c('label[for="'+e.attr("id")+'"]');f.length>0?f.addClass(a.errorClass):e.parent().get(0)&&e.parent().get(0).tagName=="LABEL"&&e.parent().addClass(a.errorClass)}a.errorMessage&&(e=c(a.message+"["+a.connector+'="'+b+'"]'),a.messages&&a.messages[b]&&(c(a.messageLabel,e).empty().append(a.messages[b][h]),
e.show()))}},o=function(){for(key in a.rules){var b=c.type(a.rules[key]);if(b==="object")for(node in a.rules[key]){var d=key,e=a.rules[key][node];j(d,node,e)}if(b==="array")for(node in d=key,a.rules[key])e=a.rules[key][node],j(d,e);else j(key,a.rules[key])}return g},j=function(b,a,c){switch(a){case "function":c instanceof Function&&(c=c(d,b),c==!1&&(g++,i[b]="function",f(b,"function")));break;case "empty":p(b)==!0&&(g++,i[b]="empty");break;case "email":q(b)==!0&&(g++,i[b]="email");break;case "number":r(b)==
!0&&(g++,i[b]="number")}a instanceof Function&&(c=a(d,b),c==!1&&(g++,i[b]="function",f(b,"function")))},p=function(b){if(c('input[name="'+b+'"]',d).length>0){var a=c.trim(c('input[name="'+b+'"]',d).val());if(a.length==0)return f(b,"empty"),!0}if(c('textarea[name="'+b+'"]',d).length>0&&(a=c.trim(c('textarea[name="'+b+'"]',d).val()),a.length==0))return f(b,"empty"),!0;return c('select[name="'+b+'"]',d).length>0&&(a=c.trim(c('select[name="'+b+'"]',d).val()),a.length==0)?(f(b,"empty"),!0):!1},q=function(b){if(c('input[name="'+
b+'"]',d).length>0){var a=c('input[name="'+b+'"]',d).val();reg=/[0-9a-z_]+@[0-9a-z_^.]+\.[a-z]{2,3}/i;return reg.test(a)?!1:(f(b,"email"),!0)}if(c('textarea[name="'+b+'"]',d).length>0)return a=c('textarea[name="'+b+'"]',d).val(),reg=/[0-9a-z_]+@[0-9a-z_^.]+\.[a-z]{2,3}/i,reg.test(a)?!1:(f(b,"email"),!0);if(c('select[name="'+b+'"]',d).length>0)return a=c('select[name="'+b+'"]',d).val(),reg=/[0-9a-z_]+@[0-9a-z_^.]+\.[a-z]{2,3}/i,reg.test(a)?!1:(f(b,"email"),!0)},r=function(a){if(c('input[name="'+a+
'"]',d).length>0){var h=c('input[name="'+a+'"]',d).val();reg=/[0-9]/i;return reg.test(h)?!1:(f(a,"number"),!0)}if(c('textarea[name="'+a+'"]',d).length>0)return h=c('textarea[name="'+a+'"]',d).val(),reg=/[0-9]/i,reg.test(h)?!1:(f(a,"number"),!0);if(c('select[name="'+a+'"]',d).length>0)return h=c('select[name="'+a+'"]',d).val(),reg=/[0-9]/i,reg.test(h)?!1:(f(a,"number"),!0)},m=function(){g=0;i={};a.errorInput&&(c("input",d).removeClass(a.errorClass),c("textarea",d).removeClass(a.errorClass),c("select",
d).removeClass(a.errorClass));a.errorLabel&&c("label").removeClass(a.errorClass);a.errorMessage&&c(a.message).hide()},l=function(b){a.errorInput&&b.removeClass(a.errorClass);if(a.errorLabel){if(!b.attr("id"))return;var h=c('label[for="'+b.attr("id")+'"]');h.length>0?h.removeClass(a.errorClass):b.parent().get(0).tagName=="LABEL"&&b.parent().removeClass(a.errorClass)}a.errorMessage&&c(a.message+"["+a.connector+'="'+b.attr("name")+'"]',d).fadeOut(50)},s=function(){if(!(!a.convert instanceof Object)){var b=
d.serializeArray(),c={};for(key in b)c[b[key].name]=b[key].value;for(convertKey in a.convert)a.convert[convertKey]instanceof Function&&(b=a.convert[convertKey](c[convertKey]),c[convertKey]=b);return c}};d.bind("hideErrors",function(){m()});d.off("submit");d.on("submit",function(b){b.preventDefault();m();c(a.alert,d).hide();a.submitCallback instanceof Function&&a.submitCallback();g=o();g>0&&a.errorCallback instanceof Function&&a.errorCallback(i);if(g==0){b=0;if(a.convert instanceof Object)b=c.map(a.convert,
function(a,c){return c}).length;b=a.convert instanceof Object&&b>0?s():d.serialize();c.ajax({type:a.type,url:n,dataType:"json",data:b,beforeSend:function(){k.fadeIn();a.block==!0&&(c('input[type="submit"]',d).attr("disabled","disabled"),c("button",d).attr("disabled","disabled"))},error:function(){k.fadeOut();a.errorCallback instanceof Function&&a.errorCallback()},success:function(b){k.fadeOut();a.block==!0&&(c('input[type="submit"]',d).removeAttr("disabled"),c("button",d).removeAttr("disabled"));
if(b.error||b.status=="error"){var e=b.errors;for(key in e)f(key,e[key]);if(a.alerts&&a.errorAlert){var e=b.errors,g=0;for(key in e){if(a.alerts[key]&&g<1){var i=c(a.alert,d),j=e[key];c(a.alertLabel,i).empty().append(a.alerts[key][j]);i.show()}g++}}a.errorCallback instanceof Function&&a.errorCallback(b)}else a.successCallback instanceof Function&&a.successCallback(b,d)}})}});c("input",d).on("keydown",function(){l(c(this))});c("textarea",d).on("keydown",function(){l(c(this))});c("select",d).on("change",
function(){l(c(this))});return"1.0"}})(jQuery);
